==== Version 2.2.0.0 (tag: map_v2_2_0_0) ====
Implements the following features:
- Double tap to zoom
- Configurable high end map controls
- Follow Me
- Non interactive Map on page load
- Updated whereis logo
- Make cross hair on high end map to be optional

Remove the usage of EMS.Util.smoothZoom() on locate me call when we have to zoom out to
display all pois including the user's location because the fraction goes too big and all
iOS crashes unless those with nitro js. Use setCenter() instead.

This version of map component will need the devicelocation component v2.0.11 or above

Update the getInitialPoiMap interface into the following
Map getInitialPoiMap(final WGS84Point mapCentre,
    		final MobilesIconType centreIconType, final InteractivePoiInfo centrePoiInfo,
            MapLayer mapLayer, final List<IconDescriptor> poiIcons,
            int mobilesZoomThreshold, final MobileContext mobileContext);
            
==== Version 2.1.0.6_host_EMS_code (tag: map_v2_1_0_6) ====

Default environment property files are no longer shipped with the component. This is due to the Mobiles team restructure.
There is no longer anything common between the environments of each app and hence the components can no longer predict 
sensible defaults.

Upgrade steps:
1. _Before you upgrade_, take the version prior to this and extract all property files that match the following pattern
    from the component's jar file:

    au/com/sensis/mobile/web/component/map/map-environment.properties.<platform>
    
2. Place these property files in your project source tree somewhere.

3. Change your build scripts to ensure that these property files result in map-environment.properties being in the
   root of your classpath at deployment time. For example:
   
   a) when building the deployment unit for dev, map-environment.properties.dev should be copied to 
      map-environment.properties in the root of the deployed app's classpath.
   b) when building the deployment unit for prd, map-environment.properties.prd should be copied to 
      map-environment.properties in the root of the deployed app's classpath.
      
4. Now you can upgrade your dependency and pull in the new version of this component.

5. For future upgrades, note that the following file in the jar is provided as a template for you to check what properties
   should be specified by your app.

    au/com/sensis/mobile/web/component/map/map-environment-template.properties


==== Version 2.1.0.5_host_EMS_code (tag: map_v2_1_0_5) ====
- Reduce the popup animation duration
- HTC A3335 and ZTE T3030 to get intermediate map

==== Version 2.1.0.4_host_EMS_code (tag: map_v2_1_0_4) ====
- Fix the unclickable issue in android

==== Version 2.1.0.3_host_EMS_code (tag: map_v2_1_0_3) ====
- Fix the unclickable link within the popup
- Optimise the multi poi pagination
- Decode any ASCII code 

==== Version 2.1.0.2_host_EMS_code (tag: map_v2_1_0_2) ====
- Remove the temporary EMS code
- Leave InteractiveIcon.js (EMS code) in the component because we need to patch
  their bugs
- Enable Android devices to get high end experience
- Fix the jitters on ipad 4

==== Version 2.0.2.6_host_EMS_code (tag: map_v2_1_0_0) ====
- Minor bug fix merged from head on interactivePoi.js
- Host EMS code within the component due to EMS performance issue on PRD (delayed EMS' prod deployment)

==== Version 2.0.2.6 (tag: map_v2_0_2_6) ====

* Include interactive poi on map
* Add dock for optional
* Map component now includes devicelocation component as well

==== Version 2.0.2.5 (tag: map_v2_0_2_5) ====

Move the crf group of image category down the stack. 

==== Version 2.0.2.4 (tag: map_v2_0_2_4) ====

Specify height for the #mapControls

==== Version 2.0.2.3 (tag: map_v2_0_2_3) ====

All JSPs and JSP tag files now set trimDirectiveWhitespaces="true".

==== Version 2.0.2.2 (tag: map_v2_0_2_2) ====

Fixed map-advanced version of render.jsp. Map variable was not being retrieved from
requestScope 'mapComponentMap' attribute.

map-intermediate version of setup.jsp: removed setting of redundant emsJsUrl variable.

==== Version 2.0.2.1 (tag: map_v2_0_2_1) ====

Jiras:
* CUI-325: Maps for Intermediate devices-  Controls on the map lock 
    * Now depends on <dependency org="com.sensis" name="wl-core-component" rev="2.0.5" conf="default,test"/>
      to fix bug with window.location sometimes containing the "#map" anchor of the <a /> that the user
      clicked.

==== Version 2.0.2 (tag: map_v2_0_2) ====

Jiras:
- CUI-322: Maps- Low end devices
    - JSPs updated to remove extraneous whitespace.

Now depends on:

        <dependency org="com.sensis" name="wl-build-scripts" rev="2.0.9" conf="buildBootstrap->default" />
        <dependency org="com.sensis" name="wl-crf" rev="0.1.2-103" conf="default" />                
        <dependency org="com.sensis" name="wl-core-component" rev="2.0.4" conf="default,test"/>        

Simplified map-crf-config.xml and javascript groups using new wl-crf capability: files with 
the same name in more specific groups mask less specific groups.                

Removed old Volantis policy files that were still in the project.

==== Version 2.0.0-005 (tag: map_v2_0_0-005) ====

Low end maps now work on XS devices.

Now depends on:
    <dependency org="com.sensis" name="wl-crf" rev="0.1.2-004" conf="default" /> 
    
Fixed missing mc_bg.gif image for L category low and intermediate devices.
Created missing HD480 images (actually same copy as the L category).

==== Version 2.0.0-004 (tag: map_v2_0_0-004) ====

Hi end maps migrated. From previous two versions:

"Low end maps work except for XS devices (the map controls do not yet render for these). 

==== Version 2.0.0-003 (tag: map_v2_0_0-003) ====

Intermediate maps migrated. From previous version:

"Low end maps work except for XS devices (the map controls do not yet render for these). 
Hi end maps do not yet work."

==== Version 2.0.0-002 (tag: map_v2_0_0-002) ====

Low end maps work except for XS devices (the map controls do not yet render for these). 
Hi end and intermediate maps do not yet work.

Now depends on:

        <dependency org="com.sensis" name="wl-build-scripts" rev="2.0.7" conf="buildBootstrap->default" />
        <dependency org="com.sensis" name="wl-crf" rev="0.1.2-003" conf="default" />        
        <dependency org="com.sensis" name="wl-webapp-testbed" rev="2.0.6" conf="showcase->default"/>        

Also changed showcase so that the map renders at the top of the page. Makes it easier to test
low end maps. 
        
Upgrade notes:
* emsManagerContext.xml
    * Apply the following regex replacement to this file:
        Replace: images/component/map/markers/(.+?)/(.*)\.png
        With:    comp/map/markers/$1/$2.image
        
      This should change all the clientImgSrcPaths to look something like:
      
        <property name="clientImgSrcPath" value="${env.ems.client.map.icons.img.src.prefix}/comp/map/markers/large/start_27x34.image" />
        
* Your web.xml must include:

    <jsp-config>
        
        <jsp-property-group>
            <url-pattern>*.jsp</url-pattern>
            <!--
              - Ensure that template text containing only whitespaces is removed from the 
              - response output. Note that this keeps whitespace from JSP tags from being
              - present in the response but whitespace before and after template text 
              - (eg. XHTML tags) will still be preserved.
              -->
            <trim-directive-whitespaces>true</trim-directive-whitespaces>
        </jsp-property-group>
        
    </jsp-config>


==== Version 2.0.0-001 (tag: map_v2_0_0-001) ====

Jakes commits. Moved images from common server into the map component project, configured
map-crf-config.xml, decomposed JSP tag files into tag files and JSP includes, copied JavaScript
to new folders.

==== Version 1.2.6 (tag: map_v1_2_6) ====

Emergency prod slap fix resulting from EMS upgrade to Decartes. patch.js now points to 
EMS (tiles?) 1.0.5 instead of 1.0.3. 

==== Version 1.2.5 (tag: map_v1_2_5) ====
Fix WMB-1658: iPad-Broken string iun Search address field in the Home page

==== Version 1.2.4 (tag: map_v1_2_4) ====
iPhone 4 graphics support

==== Version 1.2.3 (tag: map_v1_2_3) ====
* remove translate3d() so the ipad's hardware accel doesn't get triggered

==== Version 1.2.2 (tag: map_v1_2_2) ====
* Fix the full height issue that the iphone 4 has.

==== Version 1.2.1 (tag: map_v1_2_1) ====
* Remove yellow app specific code
* Improvement CUI-144 implemented
* Apple specific: target the window object for orientation change event

==== Version 1.2.0 (tag: map_v1_2_0) ====

Fixed:
- CUI-275: Device Config - infrastructure should be simplified somehow
    - See new dependencies under release notes below.
    - Deleted src/resources/xjb        
    - Added src/resources/au/com/sensis/mobile/web/component/map/device/device-config-xsd-catalog.xml
    - Regenerated the JAXB artifacts from device-config.xml using the new build scripts.

Upgrade notes:
- Now depends on:
    <dependency org="com.sensis" name="wl-build-scripts" rev="1.2.0" conf="buildBootstrap->default" />
    <dependency org="com.sensis" name="sdpCommon-manager" rev="1.1.0" conf="default"/>
    <dependency org="com.sensis" name="wl-core-component" rev="1.1.1" conf="default,test"/>                

==== Version 1.1.12 (tag: map_v1_1_12) ====

Fixed:
- CUI-271 Intermediate map-> Nokia 6120C -> Map controls freeze & stop working after sometime (Intermittent)

Other refactoring:
- Removed showcase *.mscr overrides under showcase/resources/mcs/policies in line with
  new wl-build-scripts 1.0.13. Ensured that project-environment.properties.* contains all
  properties required for MCS token replacement.
- Upgraded some libs:

    <dependency org="com.sensis" name="wl-build-scripts" rev="1.0.13" conf="buildBootstrap->default" />
    <dependency org="com.sensis" name="wl-core-component" rev="1.0.34" conf="default,test"/>
    <dependency org="com.sensis" name="wl-webapp-testbed" rev="1.0.9" conf="showcase->default"/>        
    
Upgrade notes:
- Note lib upgrades above. These really only contain changes that affect non-production code.    

==== Version 1.1.11 (tag: map_v1_1_11) ====

- Fixed:
    - CUI-248 Yellow Mobile -> Reporting events (ECS) are captured for photo & map view mode on high-end maps
        - improvement related to this Jira.  clientSideGeneratedMapStateChangeUrl only used if it is non-blank. 

	- Merged differences between 1.1.9-100 and 1.1.9-200:
    	- Iphone's client app's bdp to have special height in fullscreen mode
    	- Enable fullscreen control on androids 
    - Merged differences between 1.1.9-200 and 1.1.9-300:    	
        - Map component now allows applications to specify margins for classic and intermediate maps, based
          on the ImageCategory of the device.
            - map.comp.screenDimensionsStrategy bean is now a 
              au.com.sensis.mobile.whitepages.presentation.map.MarginAwareScreenDimensionsStrategy
              (moved in from Boyd's WPM implementation).
            - DefaultScreenDimensionsStrategy has been removed.
        - Also now depends on 
            - <dependency org="com.sensis" name="wl-build-scripts" rev="1.0.11" conf="buildBootstrap->default" />        
    
- Upgrade notes:
    - If an application wishes to specify non-zero margins for classic and intermediate maps, they must 
      create a map-component.properties file (with this exact name) in the root of their classpath and 
      override any or all of the following properties (the default values set by the component are
      shown here):
      
        comp.margin.default=0
        comp.margin.xtrasmall=0
        comp.margin.small=0
        comp.margin.medium=0
        comp.margin.large=0
        comp.margin.hd480=0
        comp.margin.hd600=0
        comp.margin.hd800=0
        comp.margin.hd1024=0
        
      Any property that the application does not specify will default to 0. Note that the 
      comp.margin.default property is only used if no ImageCategory specific property is found. 
      This caters to the event that a new ImageCategory is created but no specific property for it is 
      created in the component. 
      
      Also note that each margin property is a sum of the left and right margins so this implementation
      assumes that both left and right margins are equal.	
	
==== Version 1.1.10 (tag: map_v1_1_10) ====

- Fixed:
    - CUI-104 Map Component - (Location, POIs, Routes) - Intermediate Map - Server Side
    - CUI-105 Map Component - (Location, POIs, Routes) - Intermediate Map - Client Side
    - CUI-239 Create an Intermediate Map component
    - CUI-257 YM app -> Map in 'fulscreen' mode does not occupy complete screen size when user 
              navigates from landscape to vertical screen mode    

Upgrade notes:
- now depends on wl-core-component 1.0.33 and uses Nokia 6120 and Samsung C5220 specialisations
  from that instead of this current component. Webapps should also include the following filter in 
  their web.xml, placed after the ServletCaptureFilter or MCSFilter.

    <filter>
        <filter-name>jsonLeadingAndTrailingWhitespaceTrimmingFilter</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
        <init-param>
            <param-name>targetBeanName</param-name>
            <param-value>core.comp.jsonLeadingAndTrailingWhitespaceTrimmingFilter</param-value>
        </init-param>
        <init-param>
            <param-name>targetFilterLifecycle</param-name>
            <param-value>true</param-value>
        </init-param>
    </filter>

    <filter-mapping>
        <filter-name>jsonLeadingAndTrailingWhitespaceTrimmingFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>
- now depends on wl-webapp-testbed 1.0.8. 

==== Version 1.1.9 (tag: map_v1_1_9) ====

Fixed:
- [CUI-140] - DNF - Map testpage -> Photo view -> The Map appears to be broken when user tries to zoom out the map
- [CUI-178] - DNF - Map testpage -> Parts /tiles of the map freeze & do not load properly on T-Hub map , sometimes entire page hangs
- [CUI-220] - Map Component-Photo icon is not aligned in one line with other map controls for smaller devices like ZTE T 6 and TG Tu 550
- [CUI-224] - FULLSCREEN - Map Component - Whereis Mobile - HTC desire - Full screen mode - Pan on the map scrolling the Home page
- [CUI-225] - FULLSCREEN - Map testpage -> Homepage Map , Poi's map & Direction summary map in Fullscreen view does not occupy complete screen size on HTC desire
- [CUI-227] - Map testpage ->Zoom out control (-) appears missing when user returns to vertical screen mode from landscape mode on SEX10
- [CUI-228] - FULLSCREEN - Map testpage -> Map shrinks at the bottom when user returns to vertical screen mode from landscape mode on HTC desire
- [CUI-229] - DNF - Map testpage -> Pinch gesture on HTC desire zooms in/out the entire page
- [CUI-230] - Map testpage -> Performance issues -> Loading of map tiles is slow , and sometimes tiles freeze on HTC desire
- [CUI-233] - Map component -> Zoom in/out on SE X10 (Rachael) sometimes causes the map to exit fullscreen view (Intermittent)
- [CUI-235] - Map component -> Zoom in/out controls provided by SE X10 (Rachael) device block the 'Fulscreen' & 'zoom' map component controls
- [CUI-240] - Android (HTC Bravo + Rachel) - Map Component- Zoom controls, photo control moved from expected position after a refresh and Full screen mode
- [CUI-244] - HTC Desire - Map tiles do not load smoothly after a few pans
- [CUI-245] - Map Component - zoom out to maximum zoom breaks if EMS Manager not configured with 16 zoom levels
- [CUI-246] - Iphone Client -> Map controls appear missing in fulscreen mode on iphone Yellow client
- [CUI-248] - Yellow Mobile -> Reporting events (ECS) are captured for photo & map view mode on high-end maps
- [CUI-238] - Remove 'full width' value from the expand map, only use 'full height'

==== Version 1.1.8 (tag: map_v1_1_8) ====

Fixed:
- [CUI-191] - IPhone - Map Component- Zoom controls, photo control moved from expected position after a refresh and Full screen mode
- [CUI-230] - Map testpage -> Performance issues -> Loading of map tiles is slow , and sometimes tiles freeze on HTC desire
- [CUI-236] - Map component -> T-Hub -> Map controls freeze on T-hub map , when min /max zoom level is reached
- [CUI-241] - Map Component (Android) - disable fullscreen mode for hi end maps on Android devices

Other fixes:
- Change made for 1.1.7 has been modified. Apps no longer need a bandaid fix to work around the theme/default/style.css
  issue. Map component ensures that a valid style.css is always included from the EMS server (even though we don't
  actually need this file).

Upgrade notes:
- Please ensure that you redeploy your policies and the latest imageserver.

==== Version 1.1.7-001 (tag: map_v1_1_7-001) ====

Fixed:
- CUI-232: The routing option is not updated when the route cannot be obtained and the code has retried
    - now depends on sdpCommon-manager 1.0-074.
    - MapDelegate.getInitialRouteMap documentation updated to mention that the actual RoutingOption
      used may change.
    - Showcase now allows the user to select the "Travel By" method for routes.
    
Upgrade notes:
- Now depends on sdpCommon-manager 1.0-074.
- The RoutingOption contained in the Map.getRouteDetails() returned by MapDelegate.getInitialRouteMap
  should be used for all subsequent requests to manipulateRouteMap, getInitialRouteLegStepMap and 
  manipulateRouteLegStepMap. It should also be used to display the routing option used to the user.

==== Version 1.1.7 (tag: map_v1_1_7) ====

Fixed:
- CUI-231 Map Component (Android) - only deliver hi end maps to Rachel and HTC Desire devices

Upgrade notes:
- The EMS mobi profile appears to have a bug in which it tries to source a CSS file
  located at theme/default/style.css (note that this is a relative path). For an app like
  WM, this can result in the home/error page being loaded as CSS, incorrectly parsed
  as CSS and severely messing up the page. So as a bandaid fix, make sure you define
  this style.css file at all possible relative paths in your app.   

==== Version 1.1.6-100 (tag: map_v1_1_6-100) ====

Fixed:
- CUI-142 Map testpage -> The Route (blue coloured line) is missing on the Directions map (Intermittent)
- CUI-154 Map testpage -> Map controls appear distorted on Samsung A411 
- CUI-219 Map Component - configure IE on PCs to receive classic maps

Minor styling change at JavaScript level for hi end iphone maps.

Upgrade notes:
- Now depends on wl-core-component 1.0.28

==== Version 1.1.6-004 (tag: map_v1_1_6-004) ====

Fixed:
- CUI-210: Map Component (Android) - Route line does not render
    - Canvas renderer is used if SVG is not supported.
- CUI-211: Map Component (Android) - no map markers display (cross hair, POIs, route start and end)
    - Canvas renderer is used if SVG is not supported.
- (was reopened) CUI-100: Map Component - Configure mscr files and device-config.xml to target desired devices
    - device-config.xml user agent pattern fixed for Apple OS versions prior to 3.

==== Version 1.1.6-003 (tag: map_v1_1_6-003) ====

Fixed:
- CUI-200: Map testpage(high end)  -> Directions route does not connect start & End points completely 
    - Now depends on sdpCommon-manager 1.0-073.
    
Upgrade notes:
- Now depends on sdpCommon-manager 1.0-073.

==== Version 1.1.6-002 (tag: map_v1_1_6-002) ====

Fixed bug in device-config.xml (invalid syntax).

==== Version 1.1.6-001 (tag: map_v1_1_6-001) ====

Mainly js bug fix.
Core component updated to 1.0.27

==== Version 1.1.6 (tag: map_v1_1_6) ====

Updating version to 1.1.6 to close off Common UI iteration 1.1.6.

Fixes:
- config for largeCrossHair in emsManagerContext.xml was incorrect.

==== Version 1.1.5-009 (tag: map_v1_1_5-009) ====

Fixes:
- CUI-182: Adjust Map Heights for High End & Low end
- CUI-132 Implement the background tile for the map

Upgrade notes:
- Apple and Android maps are now 180px high instead of 200px hi. Make sure you re-deploy the policies. 
  If you don't like the new height, you can override it in your application's MCS theme file, as long 
  as your theme file is declared after the map:setup tag is called.

==== Version 1.1.5-008 (tag: map_v1_1_5-008) ====

Now depends on wl-core-component 1.0.26 to get a minor logging change that affects
dev environments.

Upgrade notes:
- Now depends on wl-core-component 1.0.26.

==== Version 1.1.5-007 (tag: map_v1_1_5-007) ====

Fixes:
- CUI-171: JavaScript Serving - possible caching issue
    - Now depends on wl-build-scripts 1.0.10.
    - All mscr files include the @project.version.complete@ token
      in JavaScript file names.
    - Now depends on wl-core-component 1.0.25.
    
Upgrade notes:
- Now depends on wl-build-scripts 1.0.10.
- Now depends on wl-core-component 1.0.25.

==== Version 1.1.5-006 (tag: map_v1_1_5-006) ====

Fixed:
- CUI-208: Map Component - update to sdpCommon-manager 1.0-071 to get large map icons for devices like thub
    - emsManagerContext.xml synchronised with WhereisMobile so that the showcase is now configured
      with the large icons.

==== Version 1.1.5-005 (tag: map_v1_1_5-005) ====

Fixed:
- CUI-193: getInitialPoiMap fails when centre of map is same as single poi location
    - Showcase contains new POI map test case "WM bassett-smith valuers near 142 Church St Brighton VIC"
      that demonstrates this bug.
- CUI-181: Behaviour of the Map Zoom Buttons displays       

Upgrade Notes:
- Now depends on sdpCommon-manager 1.0-072.

==== Version 1.1.5-004 (tag: map_v1_1_5-004) ====

Fixed:
- CUI-100: Map Component - Configure mscr files and device-config.xml to target desired devices
    
Other changes:
- Fixed map-component-jsconfig.mscr.sandpit-test to be consistent with latest configs.
- JavaScript fixes:
    - remove map.updateSize from rePosition(). call updateSize() only at doMapResize() at fullScreen.js
- map.mthm fixes:
    - assign position:relative only to those device with hi end map
    
Upgrade Notes:
- You must redeploy your policies. Also make sure that you have the latest image server.    

==== Version 1.1.5-003 (tag: map_v1_1_5-003) ====

Fixed:
-  CUI-100: Map Component - Configure mscr files and device-config.xml to target desired devices
    - device-config.xml and supporting classes updated to conform to wl-core-component 1.0.24.
    - au.com.sensis.mobile.web.component.core.device.xsd and au.com.sensis.mobile.web.component.core.device.xjb
      copied from core component so that they can be made available to the build scripts.
    - setup.tag now only calls the setup tag of dependencies if map.mapImageRetrievalDeferredToClient is true.  
- Also JavaScript refactoring to distinguish between ornaments and onmapcontrols.

Upgrade Notes:
- Now depends on wl-core-component 1.0.24.

==== Version 1.1.5-002 (tag: map_v1_1_5-002) ====

Fixed:
- CUI-146: Whereis Mobile - Naer by search Result- All POI's are not displayed in the initial displayed map
    - MapDelegateImpl.getInitialPoiMap now only calculates a bounding box, not a zoom level. The client side 
      JavaScript is responsible for calculating the zoom level based on the mobilesZoomThreshold. 
      There is no way for the server side to calculate the zoom because it doesn't know the dimensions of the 
      hi end map. 
    - Map interface has new method:
        Integer getBoundingBoxEmsJavaScriptZoomInThreshold();
    - advance/MobileEMS.js constructor accepts optional mapOptions.zoomInThreshold that is applied
      if a bounding box is specified. setup.tag updated to pass this in.
    - Showcase contains new POI map test case that exhibits this issue: "WM cafe near Tullamarine VIC".
    
- CUI-173  Map component - icons 
    
Upgrade notes:
- Now depends on sdpCommon-manager 1.0-070.
- MapDelegate.manipulatePoiMap now requires the same mobilesZoomThreshold parameter that you pass to
  getInitialPoiMap. This is only required as a consequence of fixing CUI-146 above. Given that the 
  webapp currently has no way of knowing whether the user has zoomed or panned a hi end map, there is 
  no way for the delegate to know what zoom level to use when manipulatePoiMap is called. As such,
  the implementation of manipulatePoiMap now simply displays the original POI map with possibly
  only a different mapLayer. Therefore, the manipulatePoiMap now requires the same mobilesZoomThreshold
  as getInitialPoiMap. This requirement can be changed in future if we communicate hi end map 
  zoom and pan changes to webapps.
- MapDelegate.getInitialPoiMap and MapDelegate.manipulatePoiMap will not return zoom details for
  hi end maps. Like with routing, this will have implications for WhereisMobile reporting. 

==== Version 1.1.5-001 (tag: map_v1_1_5-001) ====

Fixed:
- CUI-152: Map testpage -> Different Zoom level is observed for same map on high end & low end devices

Fixed:
- Delete the imageSizeCategory.mthm (shouldn't exist as part of the component)

==== Version 1.1.5 (tag: map_v1_1_5) ====

Marks the end of iteration 1.1.5 for the Rockit Common UI project.

Image paths for hi end map controls changed from *.png to *.gif.

==== Version 1.1.4-010 (tag: map_v1_1_4-010) ====

Fixed CUI-162: Map Component - applications unable to obtain total duration of route.

==== Version 1.1.4-009 (tag: map_v1_1_4-009) ====

Fixed CUI-166: Map component - remove JavaScript logger in non-dev environments

Ungrade notes:
- Now depends on wl-core-component 1.0.22.

==== Version 1.1.4-008 (tag: map_v1_1_4-008) ====

Fixed CUI-141: Map testpage -> Incorrect route is displayed (not connecting start & End points) for a particular direction

Upgrade notes: the upgrade should be transparent.

==== Version 1.1.4-007 (tag: map_v1_1_4-007) ====

Fixed CUI-130: Map Component - remove OpenLayers.mscr and change to use prod EMS when EMS prod drop occurs on 12 Mar 2010
- EMS.mscr.* files for showcase now use EMS prod URL.

Now depends on wl-core-component 1.0.20.

Upgrade notes:
- Your app can now define the environment variable env.ems.service.js to point
  to the production EMS server. All hi end maps should work with this.

==== Version 1.1.4-006 (tag: map_v1_1_4-006) ====

Fixed CUI-145: Whereis Mobile - Navigate between the tabs- Home page with out Map
- MapDelegate.manipulate* methods can now be safely called for devices that receive hi end maps. 

==== Version 1.1.4-005 (tag: map_v1_1_4-005) ====

Now depends on wl-core-component 1.0.19.

device-config.xml now specifies device families as device ids, such as Apple and Android-OS.

MCS theme file updated for Android-OS devices.   

==== Version 1.1.4-004 (tag: map_v1_1_4-004) ====

Fix for CUI-143 Whereis Mobile - map components with out the images.
- map-component-jsconfig.mscr config corrected to have a "/" after the 
  @env.ems.client.map.icons.img.src.prefix@ token.

==== Version 1.1.4-003 (tag: map_v1_1_4-003) ====

- Now depends on wl-core-component 1.0.18. EMS related mscr files are now sourced from 
  wl-core-component.
- setup.tag now invokes <ems:setup /> and no longer includes EMS, OpenLayers and CommMode mscr
  files directly.
- Entry and exit logging in tag files now occurs at debug level instead of info level.
- mootools dependency largely refactored out of the JavaScript.

- Upgrade notes:
    - For non-showcase webapps, the upgrade should be transparent except that you must
      redeploy your MCS policies.
    - For showcases that use the JAR from this component, note that the EMS.mscr.* properties
      that you placed in showcase/resources/mcs/policies/comp/map/scripts in your project
      should now be placed under showcase/resources/mcs/policies/comp/ems/scripts.
      You must also redeploy your MCS policies.

==== Version 1.1.4-002 (tag: map_v1_1_4-002) ====

Fixed:
- CUI-126 Map Component - High end maps icon incorrect for user selected maps

Now depends on sdpCommon-manager 1.0-068.

Showcase updated with new "Cursor Type" combo box to choose which cursor will
be displayed for the map of a location.

==== Version 1.1.4-001 (tag: map_v1_1_4-001) ====

Fixed CUI-128 Map Component - wl-map-component -1.1.4.jar depends on showcase code.

Refactored Spring contexts so that mapComponentBusinessContext.xml no longer references
any showcase code.

==== Version 1.1.4 (tag: map_v1_1_4) ====

Marks the end of iteration 1.1.4 for the Rockit Common UI project.

FIxed CUI-122 Map Component - hi end POI maps are receiving POI icons with incorrect paths,
although this requires work from the app to be really "fixed". See upgrade notes below. 

Showcase also updated with new POI search "WM bassett-smith valuers near 140 Church St Brighton VIC"
to demonstrate the POI zoom threshold logic.

Hi end map experience updated to match latest design:
- iphone and android should have controls on the map: photo/map button, zoom in/out, fullscreen 
- thub should have controls on the map: photo/map button, zoom in/out, fullscreen, plus pan controls,
  one button on each side of the map. NOTE: Firefox is now treated as the thub experience.  

Upgrade notes:
- When you define the environment property "env.ems.client.map.icons.img.src.prefix",
  make sure that it does not end in "/". Make sure that the clientImgSrcPath property 
  of the au.com.sensis.wireless.manager.mapping.MobilesIcon beans in your context
  include a "/" after the property. eg:
  
    <property name="clientImgSrcPath" 
        value="${env.ems.client.map.icons.img.src.prefix}/images/component/map/markers/standard/icon_emscell_28x28.png" />

==== Version 1.1.3-005 (tag: map_v1_1_3-005) ====

Fixed CUI-121  Map Component - POI map starting zoom level is wrong.

Now depends on sdpCommon-manager 1.0-067 containing the logic fix.

Showcase now provides two POI searches: 
- cars nearby Melbourne Vic
- bars nearby Toorak Vic

The latter search demonstrates the CUI-121 bug.

mobileToEmsZoomConversionMap and emsToMobileZoomConversionMap beans
now map zoom levels one-to-one as agreed by Alex Johnston. 

==== Version 1.1.3-004 (tag: map_v1_1_3-004) ====

LocationManager and LocationManagerImpl now moved to showcase specific packages, 
since they are not part of the component proper.

Showcase now accepts start and end address to be entered for route maps.
Showcase also now demonstrates how the state of the route leg step map zoom
can be retained when clicking between steps but reset when a new route summary
map is obtained. 

==== Version 1.1.3-003 (tag: map_v1_1_3-003) ====

Fixes for CUI-86 Map Component - Route Leg Step Maps.

MapDelegateImpl now implements:
- getInitialRouteLegStepMap
- manipulateRouteLegStepMap 
- getInitialRouteMap (client side generated map support added).

Now depends on sdpCommon-manager 1.0-066.

Showcase updated to display basic route leg step links when a route summary 
map is displayed. All route and leg step maps now work for both hi end
and classic maps. One known issue though: WhereisMobile contains
special code that tries to detect when a pan/zoom of a route summary
map returns to the original map. It is not perfect, though, and this
component does not (yet) cater to this. 

==== Version 1.1.3-002 (tag: map_v1_1_3-002) ====

Fixes for CUI-85 Map Component - Render Routes - Delegate.

MapDelegate updated with new methods:
- getInitialRouteMap
- manipulateRouteMap
- getInitialRouteLegStepMap
- manipulateRouteLegStepMap 

MapDelegateImpl implements getInitialRouteMap (except for path that needs to cater 
to client generated maps) and manipulateRouteMap. JavaScript slightly modified 
to get the hi end maps working. Showcase updated to demonstrate
rendering and manipulating a "journey summary" route map. Works for both Classic maps
and hi end maps. 

Now depends on sdpCommon-manager 1.0-065.

Upgrade notes:
- The Map interface has been refactored so that the zoom details are encapsulated
  by getZoomDetails(). I think this change should be transparent to clients since
  they are not expected to be calling these methods directly.  

==== Version 1.1.3 (tag: map_v1_1_3) ====

Fixes for:
- CUI-93 Map Component - add support for AJAX map/photo toggle, including support for retaining server side state 
- CUI-97 Map Component - Style 

Remaining TODOs (which will become new Jiras):
- Styling of map height is incorrect for low end devices.
- Styling of fullscreen toggle button alignment is incorrect.
- Server side state retention of Photo/Map toggle is not implemented yet.

Upgrade notes:
- When upgrading, you must also upgrade your common-imageserver to map_v1_1_3).

==== Version 1.0.30 (tag: map_v1_0_30) ====

Upgraded to Yoanes' latest MobileEMS.js (1.11) and mobControl_iPhone.js (1.11) from the
devhome project.

Now depends on wl-build-scripts 1.0.9 and wl-core-component 1.0.17 which collectively
fix hotswapping of JavaScript to a showcase that has been deployed using
the showcase*jar-expanded targets.

==== Version 1.0.29 (tag: map_v1_0_29) ====

Fix for "CUI-93 Map Component - add support for AJAX map/photo toggle, including support for retaining server side state".
Not yet complete since we still need Yoanes' JavaScript support.

==== Version 1.0.28 (tag: map_v1_0_28) ====

Fix for "CUI-96: Map Component - always generate icons arg in setup.tag in case 
generateServerSideMap is true in device-config.xml.". MapDelegate methods
now ensure that the returned Map contains non-empty "List<ResolvedIcon>" regardless
of whether the server side map was generated.

==== Version 1.0.27 (tag: map_v1_0_27) ====

Fixes CUI-95 Map Component - render.tag should default map/photo toggle button to "map" to
catch external hybrid map requests. Details are below.

render.tag now will now render a "Map" view link in the event that the currently displayed
MapLayer is anything other than "Map" or "Photo".

==== Version 1.0.26 (tag: map_v1_0_26) ====

Fixes CUI-92 Map Component - JS EMS authorisation must be configurable per app (WPM, WM, YM).
Details are below.

EMS.mscr.* files in src/resources/mcs/policies/comp/map/scripts reduced
to EMS.mscr.default. Url in that file replaced with the following so that 
web apps can substitute their own URL and token:

    <relative>@env.ems.service.js@@env.ems.token@</relative>
    
EMS.mscr.desk, EMS.mscr.sandpit, EMS.mscr.sandpit-dev and EMS.mscr.sandpit-test
added to showcase/resources/mcs/policies/comp/map/scripts so that the showcase
can use its own versions without having to specific a replacement token
for EMS.mscr.default. This in turn avoids figuring out how the map component
showcase would override the standard showcase policy extraction in the shared
build scripts.

Also upgraded ivy.xml to depend on the latest wl-build-scripts 1.0.8 although 
not strictly required.

Upgrade instructions for webapps:
1. Your webapp build.xml must use the sensis:extract-all-component-policies task
   from wl-build-scripts 1.0.8.
2. When calling the task, you must specify a filtersfile:

        <!--
          - Extract the policies from all components found in the core libs dir.
          -->
        <sensis:extract-all-component-policies 
            componentLibDir="${lib.dir}/jar/core" destDir="${build.dir}/work/policies"
            mcsMgrpComponentScriptsBaseUrl="${mcs.mgrp.component.scripts.base.url}"
            mcsMgrpComponentImagesBaseUrl="${mcs.mgrp.component.images.base.url}"
            platform="${project.platform}">
        
            <filtersetelements>
                   <filtersfile file="${cfg.dir}/environment.properties.${project.platform}"/>      
            </filtersetelements>
        </sensis:extract-all-component-policies>
        
   The filters file must define the following properties, where the token must be specific
   to your application and environment (here, we use the WPM dev token as an example):
   
       env.ems.service.js=http://ems.whereis.com/v1/web/js/ems/lib/EMS.js?token=
       env.ems.token=4316381136292159452
       
==== Version 1.0.25 (tag: map_v1_0_25) ====

Based on discussions with Heather and Rob, implemented DefaultScreenDimensionsStrategy 
and configured MapDelegateImpl in mapComponentBusinessContext.xml to use it by default.
Also refactored the bean definition to be a named bean (map.comp.screenDimensionsStrategy) 
so that webapps can (if they wish) substitute their own implementation.

Removed WhitePagesMobileScreenDimensionsStrategy. Removed properties that it 
used to require from map-component.properties.

Added dev and tst config files for JavaScript maps: EMS.mscr.dev and EMS.mscr.tst

==== Version 1.0.24 (tag: map_v1_0_24) ====

MapDelegate interface streamlined based on Heather's feedback during WhereisMobile integration:
- MapDelegate.Action contains new view related members:
    - MAP_VIEW
    - PHOTO_VIEW
    - HYBRID_VIEW
    - isViewAction()
- MapDelegate.manipulateMap and MapDelegate.manipulatePoiMap modified so that the
  mapLayer argument must be the existing MapLayer, not the new value (which is now
  controlled by the MapDelegate.Action value above.
  
Also updated ivy config (in .classpath) to work with latest Eclipse ivy plugins:
- Apache Ivy 2.1.0.final_20090925235825
- Apache IvyDE 2.0.0.final_200907011148-RELEASE
This allows the ivy-settings path to be project relative.

==== Version 1.0.23 (tag: map_v1_0_23) ====

Now depends on wl-core-component 1.0.15 to remove transitive dependency on struts2 
for the default configuration.

==== Version 1.0.22 (tag: map_v1_0_22) ====

MapUrlHolder renamed to Map. MapUrlHolderImpl renamed to MapImpl.

==== Version 1.0.21 (tag: map_v1_0_21) ====

MapDelegate.retrieveInitialMap renamed to getInitialMap.
Now depends on sdpCommon-manager 1.0-063 for some info logging improvements.

==== Version 1.0.20 (tag: map_v1_0_20) ====

Updated with latest MobileEMS.js from Yoanes. Rendering of POIs on
JavaScript maps now works (tested on iphone on sandpit-dev).

==== Version 1.0.19 (tag: map_v1_0_19) ====

Updates to support client side JavaScript POI maps.
- Now depends on sdpCommon-manager 1.0-062 to obtain support for resolving map icons 
  needed for client side JavaScript maps.
- Showcase updates:
    - environment properties now configure env.ems.client.map.icons.img.src.prefix property needed by latest sdpCommon-manager.
    - emsManagerContext.xml updated to set clientImgSrcPath property of MobilesIcon instances.
- MapUrlHolder contains new method "List<ResolvedIcon> getResolvedIcons();". 
  MapDelegateImpl.retrieveInitialMap and getInitialPoiMap updated to set this when
  map rendering is deferred to the client.
- Fixed paths in all *.mimg files based on restructure of component images in the image-server project.
- setup.tag updated to pass ${mapUrlHolder.resolvedIcons} to the JavaScript MobEMS constructor. 

==== Version 1.0.18 (tag: map_v1_0_18) ====

MapDelegate updated with POI support (getInitialPoiMap and manipulatePoiMap).
Showcase updated with a "Render POIs" button that demonstrates a) rendering a POI map and 
b) panning, zooming and changing between Photo/Map layers for POI maps.

==== Version 1.0.17 (tag: map_v1_0_17) ====

Fixed image paths in mapLayer.mimg and photoLayer.mimg.

==== Version 1.0.16 (tag: map_v1_0_16) ====

map.comp.deviceConfigRegistry bean is now configured via the 
comp.device.config.classpath property in map-component.properties.

Now depends on wl-core-component 1.0.14.

==== Version 1.0.15 (tag: map_v1_0_15) ====

Added au.com.sensis.mobile.web.component.map.device.xsd and now
depends on wl-build-scripts 1.0.7 for device-config-xjc target and 
wl-core-component 1.0.13 for related JAXB classes.

Added JAXB classes and xjb files generated by the device-config-xjc target.

Added new MapDeviceConfigRegistry class and injected it into the
MapDelegateImpl. device-config.xml configures whether MapDelegateImpl
will retrieve the server side map (defaults to yes).

==== Version 1.0.14 (tag: map_v1_0_14) ====

Updated to Yoanes' latest JavaScript from the devhome project.

==== Version 1.0.13 (tag: map_v1_0_13) ====

Initial zoom level for the hi end JavaScript maps (set up in setup.tag) now correctly
uses the EMS zoom level instead of the Mobiles zoom level.

==== Version 1.0.12 (tag: map_v1_0_12) ====

MapDelegate methods for obtaining a map of a location, now accept a MobilesIconType.

==== Version 1.0.11 (tag: map_v1_0_11) ====

Added MapLayer support to MapDelegate. Added photo/map layer toggle button to
render tag. Updated map controls to latest mimgs from WhereisMobile (and new
images in the imageserver project: imageserver/common/icons/mapControl).
Also now supports the faded zoom in/out image when the max/min levels are reached.

==== Version 1.0.10 (tag: map_v1_0_10) ====

Heavy refactoring of MapDelegate interface and the classes behind it. Some of this based on WhereisMobile.
Notable changes:
- MapDelegate now accepts a WGS84Point instead of a GeocodedAddress, as per WhereisMobile.
- Replaced MapResult with new MapUrlHolder interface.
- MapDelegateImpl no longer depends on the LocationManager that was inherited from WhitePagesMobile.
- The screen dimensions calculation of the device has been encapsulated behind a ScreenDimensionsStrategy
  interface. This may change in future once the real requirements become apparent.
- Fixed a bug inherited from WhitePagesMobile where panning the map moves the "centre" icon to the new centre. 
  The new implementation has been based on WhereisMobile. This relies on passing the original centre coordinate
  down to the EMSManager, whilst the new centre is encapsulated in the PanZoomDetail.
  
Also upgraded sdpCommon-manager to 1.0-059 in order to obtain new equals and hashCode methods on some
key model classes. 

==== Version 1.0.9 (tag: map_v1_0_9) ====

Upgraded to Yoanes' latest JavaScript from the devhome project.
Updated MCS mscr files to support Android-OS devices.

==== Version 1.0.8 (tag: map_v1_0_8) ====

Upgraded libs:
- sdpCommon-manager from 1.0-050 to 1.0-058.
- wl-core-component from 1.0.6 to 1.0.9.

==== Version 1.0.7 (tag: map_v1_0_7) ====

Fixed showcase bug introduced from previous release when 
publish artifact and showcase names were changed to start with "wl-" prefix.
Some config files were not updated accordingly.

==== Version 1.0.6 (tag: map_v1_0_6) ====

Deliverable from iteration 1.0.6 (and 1.0.5 since I skipped that tag) 
of the rockit Common UI project (http://jira.sensis.com.au/browse/CUI). 
These iterations focused mainly on stabilising the framework.

==== Version 1.0.4 (tag: map_v1_0_4) ====

Deliverable from iteration 1.0.4 of the rockit Common UI project 
(http://jira.sensis.com.au/browse/CUI). This iteration focused mainly 
on adding logging support to the current framework, adding a template
component and fixing up various other, smaller issues.

==== Version 1.0.3 (tag: map_v1_0_3) ====

Deliverable from iteration 1.0.3 of the rockit Common UI project 
(http://jira.sensis.com.au/browse/CUI). This iteration focused mainly 
on testing the current framework by prototyping the networknav and
map components and (locally) integrating them into WPM.

==== Version 1.0.1 (tag: v1_0_1) ====

Deliverable from iteration 1.0.1 of the rockit Common UI project 
(http://jira.sensis.com.au/browse/CUI). This iteration focused mainly 
on the project structure, testbed structure and build scripts. 
All build targets should work.
 
 